---
title: "Education21"
author: "Patricia Miller"
date: "2/13/2021"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(ggplot2)
library(gridExtra)
library(tidyverse)
library(DescTools)
```

```{r}
# Upload the data here
data <- read.csv(file='UDEP_v1.03.csv',header=TRUE, stringsAsFactors=FALSE)
# names(data)
# create a vector with all of the questions and their corresponding question numbers
questions <- data[1,]
# get rid of question rows in dataset for analysis
data <- data[-(1:2),]
data <- data[-1,]
# things needed for this knit

# delete q9b after you merge with the other rmd
data$Q9b <- ifelse(data$Q9=="Man",0, ifelse(data$Q9=="Woman",1,NA)) # men vs. women

data$Q6b <- ifelse(data$Q6<=40,0, ifelse(data$Q6>40,1,NA)) # 0-40 vs 40+

```

# 4. Quality Education

```{r Education 130 PCM}
# My Attempt


data$Q9b <- factor(data$Q9b)
data$Q6ord <- cut(as.numeric(data$Q6),c(0,14,19,29,39,49,100),labels=c("Under 15","15-19","20-29","30-39","40-49","50 and above"))

# Education 130 
# Think about the person who has the most formal education in your household. Compared to other households in your community, do you feel that this person has... 
  # Less formal education than others  (1)  
  # About the same amount of formal education as others  (10)  
  # More formal education than others  (11)  

plot1 <- data %>%
  filter(Q130 != "") %>%
  ggplot(aes(y = Q130, fill = Q130)) +
  geom_bar(show.legend = FALSE) +
  scale_fill_manual(values = c("#56B4E9", "#56B4E9","#56B4E9")) +
  scale_y_discrete(labels= c("More formal education than others" = "More","About the same amount of formal education as others" = "Same","Less formal education than others" = "Less")) +
  labs(
    title = "Comparison of Education",
    x = "Count",
    y = "" 
  ) 

```

```{r Education 114, message=FALSE,warning=FALSE}

####################   Q114: Type of education in the last 12 months

# Which of the following forms of education or training have you attended in the last 12 months?	

training_levels <- c("Grade school (including home school)","Technical and Vocational Education and Training (TVET)","Tertiary education (university, trade school, or college)","None of the above")

data$Q114 <- factor(data$Q114,levels=training_levels,ordered=TRUE)

#4.3.1 Participation rate of youth and adults in formal and non-formal education and training in the last 12 months, by sex

data <- data %>% 
  mutate(Q114b_primary=ifelse(Q114=="",NA,ifelse(Q114==training_levels[1],1,0)),
        Q114b_technical=ifelse(Q114=="",NA,ifelse(Q114==training_levels[2],1,0)),
         Q114b_tertiary=ifelse(Q114=="",NA,ifelse(Q114==training_levels[3],1,0)),
         Q114b_none=ifelse(Q114=="",NA,ifelse(Q114==training_levels[4],1,0)),
         Q114b_educ_in_last_12_months=ifelse(Q114b_primary==1|Q114b_tertiary==1|Q114b_technical==1,1,0))

# difference between the proportion of females and males participating in education in last 12 months
Education114b_overall_gendert <-t.test(Q114b_educ_in_last_12_months~Q9b,data=data)
#t.test(data$Q114b_educ_in_last_12_months[data$Q9b==1],data$Q114b_educ_in_last_12_months[data$Q9b==0])  
# difference between the proportion of females and males participating in  tertiary education in last 12 months
Education114b_tertiary_gendert <-t.test(Q114b_tertiary~Q9b,data=data) #t.test(data$Q114b_tertiary[data$Q9b==1],data$Q114b_tertiary[data$Q9b==0]) 
# difference between the proportion of females and males participating in  techical or vocational education in last 12 months
Education114b_technical_gendert <-t.test(Q114b_technical~Q9b,data=data) #t.test(data$Q114b_technical[data$Q9b==1],data$Q114b_technical[data$Q9b==0]) 
Education114b_primary_gendert <-t.test(Q114b_primary~Q9b,data=data)

# percentages - see tidyverse summary below
# Females with education in the last 12 months
Education114b_overall_female <- mean(data$Q114b_educ_in_last_12_months[data$Q9b==1], na.rm=TRUE)*100
# Males with education in the last 12 months
Education114b_overall_male <- mean(data$Q114b_educ_in_last_12_months[data$Q9b==0], na.rm=TRUE)*100
# Overall education in the last 12 months
Education114b_overall <- mean(data$Q114b_educ_in_last_12_months*100, na.rm=TRUE)
Education114b_gender_avg <- aggregate(Q114b_educ_in_last_12_months~Q9b,data=data,mean, na.rm = TRUE)*100
Education114b_gender_avg_tertiary<- aggregate(Q114b_tertiary~Q9b,data=data,mean, na.rm = TRUE)*100
Education114b_gender_avg_technical<- aggregate(Q114b_technical~Q9b,data=data,mean, na.rm = TRUE)*100
Education114b_gender_avg_primary<- aggregate(Q114b_primary~Q9b,data=data,mean, na.rm = TRUE)*100

# TRY THIS
# educ_by_gender114 <- data %>%
#   select(Q9b, Q114b_educ_in_last_12_months, Q114b_tertiary, Q114b_technical, Q114b_primary) %>%
#   group_by(Gender = Q9b) %>%
#   summarize(Education_12Months = mean(Q114b_educ_in_last_12_months, na.rm = TRUE),
#             Primary = mean(Q114b_primary, na.rm = TRUE),
#             Tertiary =  mean(Q114b_tertiary, na.rm= TRUE), 
#             Technical = mean(Q114b_technical, na.rm = TRUE))

```

```{r Education 122, message=FALSE,warning=FALSE}
########### Q122 Computer Activities

# 4.4.1 Proportion of youth and adults with information and communications technology (ICT) skills, by type of skill		4.4.1.i 	Education 122
#Can anyone in your household do the following computer activities?	
#Copying or moving a file or folder/Using copy and paste tools to duplicate or move information within a document/Sending e-mails with attached files (e.g. document, picture, video)/Using basic arithmetic formulae in a spreadsheet/Connecting and installing new devices (e.g. a modem, camera, printer)/Finding, downloading, installing and configuring software/Creating electronic presentations with presentation software (including text, images, sound, video or charts)/Transferring files between a computer and other devices/Writing a computer program using a specialized programming language

data <- data %>%
  mutate(Q122_copy_file=ifelse(Q122=="",NA,ifelse(grepl("Copying or moving a file or folder",Q122),1,0)),
         Q122_use_copy_paste=ifelse(Q122=="",NA,ifelse(grepl("Using copy and paste tools to duplicate or move information within a document",Q122),1,0)),
         Q122_send_attachments=ifelse(Q122=="",NA,ifelse(grepl("Sending e-mails with attached files",Q122),1,0)),
         Q122_use_arithmetic_spreadsheet=ifelse(Q122=="",NA,ifelse(grepl("Using basic arithmetic formulae in a spreadsheet",Q122),1,0)),
         Q122_install_devices=ifelse(Q122=="",NA,ifelse(grepl("Connecting and installing new devices",Q122),1,0)),
         Q122_install_software=ifelse(Q122=="",NA,ifelse(grepl("Finding, downloading, installing and configuring software",Q122),1,0)),
         Q122_create_presentation=ifelse(Q122=="",NA,ifelse(grepl("Creating electronic presentations with presentation software",Q122),1,0)),
         Q122_transfer=ifelse(Q122=="",NA,ifelse(grepl("Transferring files between a computer and other devices",Q122),1,0)),
         Q122_write_program=ifelse(Q122=="",NA,ifelse(grepl("Writing a computer program using a specialized programming language",Q122),1,0)),
         Q122_sum=
           Q122_copy_file+
           Q122_use_copy_paste+
           Q122_send_attachments+
           Q122_use_arithmetic_spreadsheet+
           Q122_install_devices+
           Q122_install_software+
           Q122_create_presentation+
           Q122_transfer+
           Q122_write_program)

# proportions


prop_data <-  data %>% 
  group_by() %>% 
  summarize( prop_copy_file=mean(Q122_copy_file, na.rm = TRUE),
             prop_copy_paste=mean(Q122_use_copy_paste, na.rm = TRUE),
             prop_attachments=mean(Q122_send_attachments, na.rm = TRUE),
             prop_use_arithmetic_spreadsheet=mean(Q122_use_arithmetic_spreadsheet, na.rm = TRUE),
             prop_install_devices=mean(Q122_install_devices, na.rm = TRUE),
             prop_install_software=mean(Q122_install_software, na.rm = TRUE),
             prop_create_presentation=mean(Q122_create_presentation, na.rm = TRUE),
             prop_transfer=mean(Q122_transfer, na.rm = TRUE),
             prop_write_program=mean(Q122_write_program, na.rm = TRUE))
 
prop_data <- prop_data %>%
  gather(var, val, 1:ncol(prop_data))
 

pct_by_skill <- prop_data %>%
  mutate(Skill=fct_recode(var,
                          "Copying or moving a file or folder" = "prop_copy_file",
                          "Using copy and paste tools to duplicate or move information within a document"="prop_copy_paste",
                          "Sending e-mails with attached files"="prop_attachments",
                          "Using basic arithmetic formulae in a spreadsheet"="prop_use_arithmetic_spreadsheet",
                          "Connecting and installing new devices"="prop_install_devices",
                          "Finding, downloading, installing and configuring software"="prop_install_software",
                          "Creating electronic presentations with presentation software"="prop_create_presentation",
                          "Transferring files between a computer and other devices"="prop_transfer",
                          "Writing a computer program using a specialized programming language"="prop_write_program"),
         Percent=round(val*100,1)) %>% 
  select(Skill,Percent)

plot_edu122_pct <- pct_by_skill %>% 
  ggplot(aes(x=Skill,y=Percent))+
  geom_col()+
  coord_flip()+
  labs(title="Percent of households \npossessing computer skills, \nby skill",
       x="")
plot_edu122 <- data %>% 
  ggplot(aes(x=Q122_sum))+
  geom_bar(fill="#999999")+
  labs(title="Number of computer skills in each \nhousehold",
       x="Sum of Computer Skills",
       y="Number of Households")

plot_edu124 <- data %>%
  filter( Q124 !="") %>%
  ggplot(aes(y = Q124, fill = Q124)) + 
  geom_bar(show.legend = FALSE) + 
  scale_fill_manual(values = c("#56B4E9","#56B4E9","#56B4E9")) + 
  scale_y_discrete(labels = c("More technology skills than other households" = "More", "About the same amount of technology skills as other households" = "Same", "Fewer technology skills than other households" = "Fewer")) + 
  labs(
    title = "Comparison on Technology Skills",
    x = "Count",
    y = ""
  )


```


```{r Education 128,  message=FALSE,warning=FALSE}
# Think of the person in your household with the most formal education. What is the highest level of education that person has completed?

# 4.6.1 Percentage of population in a given age group achieving at least a fixed level of proficiency in functional (a) literacy and (b) numeracy skills, by sex
              ############ since this is household level, it does not make sense to do show by age and sex. Applying to Q112 instead ############

school_levels <- c("No schooling completed","Some grade school completed","Some high school, no diploma","High school graduate, diploma or equivalent (for example: GED)","Some college credit, no degree","Trade/technical/vocational training","Associate degree","Bachelor's degree","Master's degree","Professional degree","Doctorate degree")

school_levels_numeric <- data.frame(school_levels,level=c(1:11))

data <- data %>% 
  left_join(school_levels_numeric,by=c("Q128"="school_levels")) %>%
  rename(Q128_level=level)

data <- data %>%
  mutate(Q128_proficient=ifelse(is.na(Q128_level),NA,ifelse(Q128_level>1,1,0)))

data$Q128=factor(data$Q128,levels=school_levels,ordered=TRUE)

plot_edu128 <- data %>% 
  ggplot(aes(x=fct_recode(Q128,
                          "None"=levels(data$Q128)[[1]],
                          "Some grade school"=levels(data$Q128)[[2]],
                          "Some high school"=levels(data$Q128)[[3]],
                          "High school graduate"=levels(data$Q128)[[4]],
                          "Some college credit"=levels(data$Q128)[[5]],
                          "Vocational training"=levels(data$Q128)[[6]],
                          "Associate"=levels(data$Q128)[[7]],
                          "Bachelor's"=levels(data$Q128)[[8]],
                          "Master's"=levels(data$Q128)[[9]],
                          "Professional"=levels(data$Q128)[[10]],
                          "Doctorate"=levels(data$Q128)[[11]]))) +
  geom_bar(position = "dodge",fill="#999999") +  
  theme(legend.position = c(0.8, 0.8)) +
  coord_flip() +
  scale_x_discrete(drop=FALSE) +
  labs(title="Education level of most \neducated member of \nhousehold",
       x="")


```

```{r Education 112, message=FALSE,warning=FALSE}

# What is the highest degree or level of school you have completed? (Include highest grade level completed or area of study if applicable.)


# 4.6.1 Percentage of population in a given age group achieving at least a fixed level of proficiency in functional (a) literacy and (b) numeracy skills, by sex


data <- data %>% 
  left_join(school_levels_numeric,by=c("Q112"="school_levels")) %>%
  rename(Q112_level=level)

data <- data %>%
  mutate(Q112_proficient=ifelse(is.na(Q112_level),NA,ifelse(Q112_level>1,1,0)))

men_gradeschool <- round(mean(data$Q112_proficient[data$Q9b==0], na.rm = TRUE)*100,1)
women_gradeschool <- round(mean(data$Q112_proficient[data$Q9b==1], na.rm = TRUE)*100,1)

data$Q112=factor(data$Q112,levels=school_levels,ordered=TRUE)

plot_edu112 <- data %>% 
  ggplot(aes(y=fct_recode(Q112,
                          "None"=levels(data$Q112)[[1]],
                          "Some grade school"=levels(data$Q112)[[2]],
                          "Some high school"=levels(data$Q112)[[3]],
                          "High school graduate"=levels(data$Q112)[[4]],
                          "Some college credit"=levels(data$Q112)[[5]],
                          "Vocational training"=levels(data$Q112)[[6]],
                          "Associate"=levels(data$Q112)[[7]],
                          "Bachelor's"=levels(data$Q112)[[8]],
                          "Master's"=levels(data$Q112)[[9]],
                          "Professional"=levels(data$Q112)[[10]],
                          "Doctorate"=levels(data$Q112)[[11]]),
             fill=Q9b))+
  geom_bar(position = "dodge") +  
  scale_fill_manual(values=c("#999999", "#56B4E9"),
                         name="",
                         breaks=c(0, 1),
                         labels=c("Male", "Female"))+
  labs(title = "Individual education level \nby age and sex",
       x="Count",
       y = "") +
  facet_grid(rows=vars(fct_recode(factor(Q6b),
                                  "40 years old and younger"="0",
                                  "Above 40 years old"="1")))


menwomendiff <- if(men_gradeschool !=  women_gradeschool){
    paste0("(",men_gradeschool,"% of men and ",women_gradeschool,"% of women).")
} else {
    ". There is no difference between the percent of men and women with at least some grade school completed."
  }

menwomen_ttest <- t.test(data$Q112_proficient~Q9b,data)

```

# Education

`r round(mean(data$Q128_proficient, na.rm = TRUE)*100,1)`% of households have somebody with at least some grade school completed. \
\
When asked to compare the most educated person in their household to other members of the community, `r round(mean(data$Q130 == "Less formal education than others", na.rm = TRUE)*100)`% said they had less education than members of the community, `r round(mean(data$Q130 == "About the same amount of formal education as others", na.rm = TRUE)*100)`% said they had about the same amount education as most households, and `r round(mean(data$Q130 == "More formal education than others", na.rm = TRUE)*100)`% said they had more formal education than others.

```{r, message=FALSE, warning=FALSE,fig.height=3,fig.width=8}

grid.arrange(plot_edu128, plot1, ncol = 2)

```
\

`r round(mean(data$Q112_proficient, na.rm = TRUE)*100,1)`% of respondents have at least some some grade school completed`r menwomendiff`

`r round(Education114b_overall,1)`% of all the participants have participated in education or vocational training in the past 12 months. `r round(Education114b_gender_avg[1,2],1)`% of men in the sample have participated and `r round(Education114b_gender_avg[2,2],1)`% of women in the sample have participated. `r if(Education114b_overall_gendert$p.value<=0.05 & Education114b_gender_avg[1,2] > Education114b_gender_avg[2,2]) {"A difference of means indicates that significantly more men participated in educational or training activites in the past 12 months than women."}` `r if(Education114b_overall_gendert$p.value<=0.05 & Education114b_gender_avg[1,2] < Education114b_gender_avg[2,2]) {"A difference of means test indicates that significantly more women participated in educational or training activities in the past 12 months than men."}` `r if(Education114b_overall_gendert$p.value>0.05) {"However, the difference in education/training participation between men and women is not significant."}`

<!-- Education type breakdown -->

Of the women in the sample, `r round(Education114b_gender_avg_tertiary[2,2],1)`% are or were enrolled in college, university, or trade school, `r round(Education114b_gender_avg_technical[2,2],1)`% are or were enrolled in technical or vocational training, and `r round(Education114b_gender_avg_primary[2,2],1)`% are or were enrolled in grade school.

Of the men in the sample, `r round(Education114b_gender_avg_tertiary[1,2],1)`% are or were enrolled in college, university, or trade school, `r round(Education114b_gender_avg_technical[1,2],1)`% are or were enrolled in technical or vocational training (TVET), and `r round(Education114b_gender_avg_primary[1,2],1)`% are or were enrolled in grade school.

```{r message=FALSE, warning=FALSE, fig.height=4,fig.width=8}

plot_edu114 <- data %>% 
  select(Q9b, Q114) %>% 
  ggplot(aes(x=fct_recode(Q114,
                        "None"=training_levels[[4]],
                        "College"=training_levels[[3]],
                        "TVET"=training_levels[[2]],
                        "Grade school"=training_levels[[1]]),fill=Q9b))+
  ggtitle("Participation in education and \ntraining in the past 12 months, \nby sex") + 
  geom_bar(position = "dodge",show.legend = FALSE)+
  xlab("")+
  coord_flip()+
  scale_fill_manual(values=c("#999999", "#56B4E9"),
                         name="",
                         breaks=c(0, 1),
                         labels=c("Male", "Female"))+
  scale_x_discrete(drop=FALSE)

grid.arrange(plot_edu112, plot_edu114,ncol=2) 

```

## Computer Activities

Of the following nine computer skills, the average number that each household possesses is `r round(mean(data$Q122_sum, na.rm = TRUE),1)`.

-   `r pct_by_skill[[2]][1]`% of respondents live with someone able to copy or move a file or folder.
-   `r pct_by_skill[[2]][2]`% of respondents live with someone able to use copy and paste tools to duplicate or move information within a document.
-   `r pct_by_skill[[2]][3]`% of respondents live with someone able to send e-mails with attached files (e.g. document, picture, video).
-   `r pct_by_skill[[2]][4]`% of respondents live with someone able to use basic arithmetic formulae in a spreadsheet.
-   `r pct_by_skill[[2]][5]`% of respondents live with someone able to connect and install new devices (e.g. a modem, camera, printer).
-   `r pct_by_skill[[2]][6]`% of respondents live with someone able to find, download, install, and configure software.
-   `r pct_by_skill[[2]][7]`% of respondents live with someone able to create electronic presentations with presentation software (including text, images, sound, video or charts).
-   `r pct_by_skill[[2]][8]`% of respondents live with someone able to transfer files between a computer and other devices.
-   `r pct_by_skill[[2]][9]`% of respondents live with someone able to Writing a computer program using a specialized programming language.

When asked to compare their household's technology skills to those of other members of the community, `r round(mean(data$Q124 == "Fewer technology skills than other households", na.rm = TRUE)*100)`% said they had fewer technology skills than other households, `r round(mean(data$Q130 == "About the same amount of technology skills as other households", na.rm = TRUE)*100)`% said they had about the about the same amount of technology skills as other households, and `r round(mean(data$Q130 == "More technology skills than other households", na.rm = TRUE)*100)`% said they had more technology skills than other households.

```{r, message=FALSE, warning=FALSE,fig.height=3,fig.width=8}
grid.arrange(plot_edu122,plot_edu124,ncol=2)
```
